/* src/controller/style.css */

:root {
  --max-width: none !important;
}

/* 2. Reset the main container */
#observablehq-main {
  display: flex;
  flex-direction: column;
  
  /* CRITICAL: Do NOT set width to 100%. 
     'auto' allows it to fill the space next to the sidebar naturally. */
  width: auto !important; 
  
  /* Remove the default center-column constraints */
  max-width: none !important;
  margin: 0 !important;
  
  /* Add standard padding so content doesn't touch the sidebar immediately */
  padding: 1rem !important; 
  
  /* Ensure padding is calculated inside the box size */
  box-sizing: border-box;
}


#page-header {
  width: 100%; margin: 0; text-align: center; padding: 5px 20px 1px 20px;
  font-family: sans-serif; box-sizing: border-box;
}

#page-header h1 { margin: 0; color: #333; font-size: 2rem; }

.top-controls-wrapper {
  display: flex; justify-content: space-between; align-items: center;
  gap: 20px; padding: 8px 20px; width: 100%; margin: 0;
  font-family: sans-serif; box-sizing: border-box;
}

.filter-container {
  display: flex; border: 1px solid #aaa; border-radius: 5px;
  overflow: hidden; flex: 1; min-width: 0; background-color: #e7f3ff;
}

.filter-label, .price-label {
  padding: 8px 16px; background-color: #e0e0e0; color: #333;
  font-weight: bold; font-size: 14px; border-right: 1px solid #aaa;
  display: flex; align-items: center; white-space: nowrap; cursor: default;
}

#top-filter-display {
  border: none; border-radius: 0; background-color: transparent;
  padding: 6px 15px; font-size: 14px; flex: 1; min-width: 0;
  display: flex; align-items: center;
}

#top-filter-display ul {
  list-style: none; padding: 0; margin: 0; display: flex; flex-wrap: wrap; gap: 5px 20px;
}

#top-filter-display li {
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
  max-width: 300px; line-height: 1.4;
}

.price-selector { display: flex; border-radius: 5px; overflow: hidden; border: 1px solid #aaa; flex-shrink: 0; }
.price-selector input[type="radio"] { display: none; }
.price-selector label {
  padding: 8px 16px; cursor: pointer; background: #f0f0f0; user-select: none;
  transition: background 0.2s; font-size: 14px; display: flex; align-items: center;
}
.price-selector input[type="radio"]:checked + label { background: #007bff; color: white; font-weight: bold; }
.price-selector label:not(:last-of-type) { border-right: 1px solid #aaa; }

#main-container {
  display: flex; width: 100%; border: 3px solid #444; border-radius: 5px;
  font-family: sans-serif; margin: 0; box-sizing: border-box;
  height: 75vh; min-height: 600px;
}

#map-container { flex: 1; height: 100%; display: flex; flex-direction: column; position: relative; min-width: 0; }
#map { height: calc(100% - 40px); width: 100%; }
#controls-container {
  height: 40px; display: flex; align-items: center; padding: 0 15px;
  border-top: 1px solid #ccc; background: #f8f9fa; gap: 10px;
}

#controls-container button { cursor: pointer; padding: 4px 10px; margin-right: 5px; font-size: 13px; }
#avg-btn { font-size: 11px !important; padding: 6px 4px !important; }

#speed-box { display: flex; flex-direction: column; align-items: center; justify-content: center; width: 60px; margin-right: 5px; }
#speed-box label { font-size: 9px; color: #666; line-height: 1; margin-bottom: 2px; }
#speed-slider { width: 100%; cursor: pointer; height: 5px; }

#time-display { font-size: 16px; min-width: 150px; text-align: right; }

#sidebar {
  width: 310px; height: 100%; border-left: 1px solid #ccc;
  background: #f8f9fa; flex-shrink: 0; display: flex; flex-direction: row;
}

#zone-section { width: 130px; display: flex; flex-direction: column; overflow: hidden; border-right: 1px solid #ccc; }
#constraint-section { width: 180px; display: flex; flex-direction: column; overflow: hidden; }

h4 {
  height: 30px; padding: 0 10px; margin: 0; background-color: #e9ecef;
  border-bottom: 1px solid #ccc; display: flex; align-items: center;
  justify-content: center; text-align: center; font-size: 13px; color: #333; flex-shrink: 0;
}
#zone-section h4 { height: 47px; border-bottom: 1px solid #ccc; }

.constraint-header-wrapper {
  height: 48px; box-sizing: border-box; background-color: #e9ecef;
  border-bottom: 1px solid #ccc; padding: 0 5px; display: flex;
  flex-direction: column; justify-content: center; flex-shrink: 0;
}
.constraint-header-wrapper h4 { margin: 0; border: none; background: none; padding-bottom: 2px; height: auto; width: 100%; }

.congestion-info-popup .maplibregl-popup-content {
  background: rgba(255, 255, 255, 0.95); border: 1px solid #999;
  box-shadow: 0 4px 10px rgba(0,0,0,0.3); border-radius: 6px; padding: 10px;
}
.congestion-info-popup .maplibregl-popup-tip { display: none; }

.c-toggle-container { display: flex; justify-content: center; gap: 10px; font-size: 10px; z-index: 5; }
.c-toggle-container label { cursor: default; display: flex; align-items: center; gap: 3px; opacity: 1; }
.c-toggle-container input[type="radio"]:checked { accent-color: #007bff; }

#zone-list, #constraint-list { flex: 1; overflow-y: auto; background: #6f726dff; }

.zone-item, .constraint-row {
  padding: 2.5px 2px; border-bottom: 1px solid #ccc; font-size: 12px;
  display: flex; justify-content: space-between; align-items: center;
}
.zone-item { cursor: pointer; }
.zone-item:hover { background-color: #e2e6ea; }
.zone-item.selected { background-color: #afb7c0ff; color: white; font-weight: bold; }
.zone-item .zone-price { font-weight: bold; min-width: 40px; text-align: right; }

.constraint-row .c-name { flex: 1; margin-right: 5px; word-wrap: break-word; line-height: 1.1; font-size: 10px; }
.constraint-row .c-price { font-weight: bold; color: #2f37d3ff; white-space: nowrap; font-size: 14px; }

.empty-state { padding: 15px; text-align: center; color: #666; font-style: italic; font-size: 11px; }

#legend {
  display: none; position: absolute; bottom: 50px; left: 10px; width: 120px;
  max-height: 300px; overflow-y: auto; background-color: rgba(255, 255, 255, 0.95);
  padding: 10px; border-radius: 5px; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
  font-family: sans-serif; font-size: 12px; line-height: 1.4; z-index: 100;
}
#legend strong { display: block; margin-bottom: 6px; font-size: 13px; border-bottom: 1px solid #ccc; padding-bottom: 4px; color: #333; }
.legend-item { display: flex; align-items: center; margin-bottom: 3px; }
.legend-color { width: 16px; height: 16px; border-radius: 3px; margin-right: 8px; border: 1px solid rgba(0,0,0,0.2); flex-shrink: 0; }

/* Congestion Popup Styles */
.congestion-popup-content {
    font-family: sans-serif;
    text-align: center;
    color: #333;
}
.congestion-header {
    display: block;
    border-bottom: 1px solid #ccc;
    margin-bottom: 8px;
    padding-bottom: 4px;
    font-size: 13px;
}
.congestion-body {
    font-size: 11px;
    line-height: 1.4;
}
.congestion-highlight {
    background-color: #333;
    color: #FFFF00;
    padding: 1px 4px;
    font-weight: bold;
    border-radius: 3px;
}

/* Zone Hover Popup */
.zone-popup-content {
    font-family: sans-serif;
    padding: 4px;
    text-align: left;
}

.zone-popup-header {
    font-size: 13px;
    font-weight: bold;
    display: block;
    margin-bottom: 2px;
}

.zone-popup-label {
    color: #555;
    font-size: 11px;
    text-transform: uppercase;
    margin-right: 4px;
}

.zone-popup-value {
    font-weight: bold;
    font-size: 13px;
    color: #000;
}

/* Reference Popup (Shift+Click) */
.reference-popup {
    font-size: 11px; 
    font-weight: bold; 
    color: #8B4513;
    padding: 2px;
}
